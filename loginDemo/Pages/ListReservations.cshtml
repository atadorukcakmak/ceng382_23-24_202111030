@page
@model loginDemo.Pages.ListReservationsModel
@{
    ViewData["Title"] = "List Reservations";
}

<style>
    .search{
        background-color: #ffffff; 
        border-radius: 5px; 
        padding: 20px; 
        box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        margin-bottom: 20px; 
    }
    
    body {
    background-image: url('/photos/background2.jpg');
    background-size: cover;
}
    body {
        font-family: Arial, sans-serif;
        background-color: #f8f9fa;
        margin: 20px;
    }
    h1, h2, h3 {
        color: #343a40;
    }
    .room {
        background-color: #ffffff;
        border: 1px solid #dee2e6;
        border-radius: 5px;
        padding: 20px;
        margin-bottom: 20px;
        box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }
    .room h2 {
        margin-top: 0;
    }
    .table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 10px;
    }
    .table th, .table td {
        border: 1px solid #dee2e6;
        padding: 8px;
        text-align: left;
    }
    .table th {
        background-color: #f1f1f1;
    }
    form {
        margin-top: 10px;
    }
    .btn {
        padding: 10px 15px;
        border: none;
        border-radius: 3px;
        cursor: pointer;
    }
    .btn-primary {
        background-color: #007bff;
        color: #ffffff;
    }
    .btn-danger {
        background-color: #dc3545;
        color: #ffffff;
    }
    form input[type="datetime-local"] {
        margin-right: 10px;
    }
    ul {
        list-style-type: none;
        padding-left: 0;
    }
    ul li {
        margin: 5px 0;
    }
</style>

<div class="search">
<h1 class="search-heading">Take a Look at Available Rooms</h1>
<div class="rectangle"></div>

<form method="get" asp-page="ListReservations" class="room-search-form">
    <div class="form-group">
        <label for="SearchStartTime">Start Time</label>
        <input type="datetime-local" id="SearchStartTime" name="SearchStartTime" required class="form-control" />
    </div>
    <div class="form-group">
        <label for="SearchEndTime">End Time</label>
        <input type="datetime-local" id="SearchEndTime" name="SearchEndTime" required class="form-control" />
    </div>
    <div class="rectangle"></div>
    <button type="submit" class="btn btn-primary">Search</button>
</form>





@if (Model.AvailableRooms != null)
{
    <h2>Available Rooms</h2>
    <ul>
        @foreach (var room in Model.AvailableRooms)
        {
            <li>
                <img src="@room.PhotoPath" alt="@room.Name" style="width: 100px; height: 100px; margin-right: 10px;" />
                @room.Name
            </li>
        }
    </ul>
}</div>

<br><br>
<h1>List of All Our Rooms</h1>

@foreach (var room in Model.Rooms)
{
    <div class="room">
        <h2>@room.Name</h2>
        <p>@room.Description</p>
        <p>Capacity: @room.Capacity</p>
        <img src="@room.PhotoPath" alt="Room Photo" style="width:200px;height:150px;"/>

        <h3>Weekly Schedule</h3>
        <table class="table">
            <thead>
                <tr>
                    <th>Reservation Start Time</th>
                    <th>Reservation End Time</th>
                    <th>Status</th>
                </tr>
            </thead>
            <tbody>
            @foreach (var reservation in room.Reservations)
            {
                <tr>
                    <td>@reservation.StartTime</td>
                    <td>@reservation.EndTime</td>
                    <td>@(reservation.IsCancelled ? "Cancelled" : "Booked")</td>
                </tr>
            }
            </tbody>
        </table>

        <form method="post" asp-page-handler="Reserve" asp-route-roomId="@room.Id">
            <input type="datetime-local" name="startTime" required />
            <input type="datetime-local" name="endTime" required />
            <button type="submit" class="btn btn-primary">Reserve</button>
        </form>

        <h3>Cancel Reservation</h3>
        <ul>
            @foreach (var reservation in room.Reservations)
            {
                <li>
                    @reservation.StartTime - @reservation.EndTime
                    <form method="post" asp-page-handler="Cancel" asp-route-id="@reservation.Id">
                        <button type="submit" class="btn btn-danger">Cancel</button>
                    </form>
                </li>
            }
        </ul>
    </div>
}
